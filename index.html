<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>YACHT DICE</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
 <link rel="icon" href="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQY-7LsLHb46Jk3A3IwL_IlpwosDqtVjUC79-vYQ7SMzQ&s=10" sizes="16√ó16" type="image/png" />  
<style>
body {
  margin:0; background:#222; color:#fff; font-family:sans-serif;
  display:flex; justify-content:center;
}
#game { max-width:420px; width:100%; padding:10px; }
button { padding:8px 12px; margin:4px; font-size:16px; }
.dice { font-size:40px; margin:5px; cursor:pointer; }
.hold { opacity:0.4; }
table { width:100%; border-collapse:collapse; }
td,th { border:1px solid #555; padding:4px; text-align:center; }
.active { background:#0a0; }
.win { animation: flash 0.5s infinite alternate; }
@keyframes flash { from{background:#ff0;} to{background:#f00;} }
   footer {
           padding: 30px;
           text-align: center;
           font-size: 0.85rem;
           color: rgba(255,255,255,0.5);
           border-top: 1px solid rgba(255,255,255,0.1);
           margin-top: 60px;
   }
</style>
</head>

<body>
<div id="game">

<h2>üé≤ „É®„ÉÉ„Éà„ÉÄ„Ç§„Çπ</h2>

<div id="setup">
‰∫∫Êï∞:
<select id="players">
<option value="1">1‰∫∫</option>
<option value="2">2‰∫∫</option>
<option value="3">3‰∫∫</option>
<option value="4">4‰∫∫</option>
</select><br>

CPUÊï∞:
<select id="cpu">
<option value="0">0</option>
<option value="1">1</option>
<option value="2">2</option>
<option value="3">3</option>
</select><br>

CPUÂº∑„Åï:
<select id="cpuLevel">
<option value="easy">Easy</option>
<option value="normal">Normal</option>
<option value="hard">Hard</option>
<option value="lunatic">Lunatic</option>
</select><br><br>

<button onclick="startGame()">START</button>
</div>

<div id="play" style="display:none;">
<h3 id="turn"></h3>

<div id="diceArea"></div>
<button onclick="roll()">ROLL</button>

<table id="score"></table>

<button onclick="toggleSound()">üîä Èü≥</button>
</div>

</div>

   <footer>
       ¬© 2025 GAMEHUB - All Rights Reserved.
   </footer>


<script>
let dice=[], hold=[], rolls=3;
let players=[], current=0;
let sound=true;

const cats=["1","2","3","4","5","6","3D","4D","FH","SS","LS","Y","C"];

function randDice(){ return Math.floor(Math.random()*6)+1; }

function startGame(){
  const p=+playersEl.value, c=+cpu.value;
  const lvl=document.getElementById("cpuLevel").value;
  players=[];
  for(let i=0;i<p;i++){
    players.push({
      name: i<p-c?`P${i+1}`:`CPU${i+1}`,
      cpu:i>=p-c,
      level:lvl,
      score:{},
      yacht:0
    });
  }
  document.getElementById("setup").style.display="none";
  document.getElementById("play").style.display="block";
  nextTurn();
}

function nextTurn(){
  rolls=3;
  dice=Array.from({length:5},randDice);
  hold=[false,false,false,false,false];
  render();
  if(players[current].cpu) setTimeout(cpuPlay,600);
}

function roll(){
  if(rolls<=0) return;
  dice=dice.map((v,i)=>hold[i]?v:randDice());
  rolls--;
  render();
}

function render(){
  document.getElementById("turn").textContent=
    players[current].name+" „ÅÆÁï™ (ÊÆã„Çä:"+rolls+")";

  const d=document.getElementById("diceArea");
  d.innerHTML="";
  dice.forEach((v,i)=>{
    const s=document.createElement("span");
    s.textContent=v;
    s.className="dice"+(hold[i]?" hold":"");
    s.onclick=()=>{hold[i]=!hold[i]; render();}
    d.appendChild(s);
  });

  drawScore();
}

function drawScore(){
  const t=document.getElementById("score");
  t.innerHTML="<tr><th>ÂΩπ</th><th>ÁÇπ</th></tr>";
  cats.forEach(c=>{
    const tr=document.createElement("tr");
    const td1=document.createElement("td");
    td1.textContent=c;
    const td2=document.createElement("td");
    td2.textContent=players[current].score[c]??"";
    td2.onclick=()=>choose(c);
    tr.append(td1,td2);
    t.appendChild(tr);
  });
}

function choose(c){
  if(players[current].score[c]!=null) return;
  players[current].score[c]=calc(c);
  current=(current+1)%players.length;
  nextTurn();
}

function calc(c){
  const cnt=[0,0,0,0,0,0];
  dice.forEach(v=>cnt[v-1]++);
  const sum=dice.reduce((a,b)=>a+b,0);

  if("123456".includes(c)) return cnt[c-1]*c;
  if(c==="3D") return cnt.some(v=>v>=3)?sum:0;
  if(c==="4D") return cnt.some(v=>v>=4)?sum:0;
  if(c==="FH") return cnt.includes(3)&&cnt.includes(2)?25:0;
  if(c==="SS") return ["1234","2345","3456"].some(s=>[...s].every(n=>cnt[n-1]))?30:0;
  if(c==="LS") return ["12345","23456"].some(s=>[...s].every(n=>cnt[n-1]))?40:0;
  if(c==="Y"){
    if(cnt.includes(5)){
      players[current].yacht++;
      return players[current].yacht>1?100:50;
    }
    return 0;
  }
  if(c==="C") return sum;
}

function cpuPlay(){
  const lv=players[current].level;
  if(lv==="easy"){ roll(); setTimeout(()=>choose(randCat()),400); }
  else if(lv==="normal"){ roll(); roll(); setTimeout(()=>choose(bestCat()),500); }
  else if(lv==="hard"){ roll(); roll(); roll(); setTimeout(()=>choose(bestCat()),600); }
  else{
    roll(); roll(); roll();
    setTimeout(()=>choose(bestCat()),700);
  }
}

function bestCat(){
  let best=null,max=-1;
  cats.forEach(c=>{
    if(players[current].score[c]==null){
      let v=calc(c);
      if(v>max){max=v;best=c;}
    }
  });
  return best;
}

function randCat(){
  return cats.filter(c=>players[current].score[c]==null)
             [Math.floor(Math.random()*cats.length)];
}

function toggleSound(){ sound=!sound; }

const playersEl=document.getElementById("players");
</script>
</body>
</html>
