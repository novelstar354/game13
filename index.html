<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>YACHT DICE</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body{margin:0;font-family:sans-serif;background:#222;color:#fff;text-align:center}
button,select{font-size:16px;padding:6px;margin:4px}
#dice{margin:10px}

.dice{
  font-size:42px;
  margin:6px;
  display:inline-block;
  cursor:pointer;
  transition:.3s;
}
.dice.roll{animation:roll .4s}
.dice.hold{color:gold;transform:translateY(-10px) scale(1.1);text-shadow:0 0 10px gold}

@keyframes roll{
  0%{transform:rotate(0)}
  50%{transform:rotate(180deg) scale(1.3)}
  100%{transform:rotate(360deg)}
}

table{margin:auto;border-collapse:collapse}
td,th{border:1px solid #888;padding:6px}

.scorePop{
  animation:pop .4s;
}
@keyframes pop{
  0%{transform:scale(0);opacity:0}
  80%{transform:scale(1.2)}
  100%{transform:scale(1)}
}

#effect{
  position:fixed;
  inset:0;
  pointer-events:none;
  font-size:40px;
  display:flex;
  align-items:center;
  justify-content:center;
  animation:flash .8s;
}
@keyframes flash{
  0%{background:rgba(255,215,0,.6)}
  100%{background:transparent}
}
</style>
</head>
<body>

<h1>ðŸŽ² YACHT DICE</h1>

<select id="cpuLevel">
<option value="easy">CPU EASY</option>
<option value="normal">CPU NORMAL</option>
<option value="hard">CPU HARD</option>
<option value="veryhard">CPU VERY HARD</option>
<option value="lunatic">CPU LUNATIC</option>
</select>

<div id="dice"></div>
<button onclick="roll()">ROLL</button>

<h3>PLAYER SCORE</h3>
<table id="scoreTable"></table>

<div id="effect"></div>

<script>
let dice=[1,1,1,1,1];
let hold=[0,0,0,0,0];
let rolls=3;
let yachtCount=0;

const cats=["ones","twos","threes","fours","fives","sixes","three","four","full","small","large","choice","yacht"];
let used={player:{},cpu:{}};

function init(){
  const t=document.getElementById("scoreTable");
  t.innerHTML="";
  cats.forEach(c=>{
    let r=t.insertRow();
    r.insertCell().textContent=c;
    let p=r.insertCell();
    p.id="p_"+c;
    p.onclick=()=>selectScore(c);
  });
}
init();

function roll(){
  if(rolls<=0)return;
  rolls--;
  for(let i=0;i<5;i++){
    if(!hold[i]) dice[i]=Math.floor(Math.random()*6)+1;
  }
  render(true);
}

function render(anim){
  const d=document.getElementById("dice");
  d.innerHTML="";
  dice.forEach((v,i)=>{
    let s=document.createElement("span");
    s.textContent="ðŸŽ²"+v;
    s.className="dice"+(hold[i]?" hold":"")+(anim?" roll":"");
    s.onclick=()=>{hold[i]=!hold[i];render()};
    d.appendChild(s);
  });
}

function scoreCalc(){
  let c=[1,2,3,4,5,6].map(n=>dice.filter(d=>d===n).length);
  return {
    ones:c[0],twos:c[1]*2,threes:c[2]*3,fours:c[3]*4,fives:c[4]*5,sixes:c[5]*6,
    three:c.some(v=>v>=3)?dice.reduce((a,b)=>a+b,0):0,
    four:c.some(v=>v>=4)?dice.reduce((a,b)=>a+b,0):0,
    full:(c.includes(3)&&c.includes(2))?25:0,
    small:([1,2,3,4].every(n=>dice.includes(n))||[2,3,4,5].every(n=>dice.includes(n))||[3,4,5,6].every(n=>dice.includes(n)))?30:0,
    large:([1,2,3,4,5].every(n=>dice.includes(n))||[2,3,4,5,6].every(n=>dice.includes(n)))?40:0,
    choice:dice.reduce((a,b)=>a+b,0),
    yacht:c.includes(5)?50:0
  };
}

function selectScore(c){
  if(used.player[c])return;
  let sc=scoreCalc()[c];
  if(c==="yacht" && sc===50 && yachtCount>0){
    sc+=100;
    showEffect("ðŸŽ‰ YACHT BONUS +100!");
  }
  if(c==="yacht" && sc>=50){
    yachtCount++;
    showEffect("ðŸš¤ YACHT!");
  }
  used.player[c]=true;
  let cell=document.getElementById("p_"+c);
  cell.textContent=sc;
  cell.classList.add("scorePop");
  rolls=3;
  hold=[0,0,0,0,0];
}

function showEffect(txt){
  const e=document.getElementById("effect");
  e.textContent=txt;
  e.style.display="flex";
  setTimeout(()=>e.style.display="none",800);
}

render();
</script>

</body>
</html>
