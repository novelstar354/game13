<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>YACHT DICE</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
 <link rel="icon" href="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQ2hfa6mn-kAuE5rhjik7bwe6PzZ8oXsfc0Jy-2v19_MN24r8jwd9kUFdXP&s=10" sizes="16Ã—16" type="image/png" />  
<style>
body{margin:0;background:#222;color:#fff;font-family:sans-serif;display:flex;justify-content:center;}
#game{max-width:420px;width:100%;padding:10px;}
button{padding:6px 10px;margin:4px;font-size:15px;}
button:disabled{opacity:.4}
.dice{font-size:40px;margin:5px;cursor:pointer;transition:.2s;}
.hold{opacity:.4;transform:scale(.9);}
table{border-collapse:collapse;margin:6px 0;width:100%}
td,th{border:1px solid #555;padding:4px;text-align:center;font-size:13px;}
.active{background:#0a0;}
footer{margin-top:40px;font-size:12px;text-align:center;opacity:.5}

/* ===== ãƒ«ãƒ¼ãƒ«ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ— ===== */
#ruleOverlay{
  position:fixed; inset:0;
  background:rgba(0,0,0,.7);
  display:none;
  align-items:center;
  justify-content:center;
  z-index:999;
}
#ruleBox{
  background:#111;
  border:2px solid #888;
  border-radius:10px;
  padding:15px;
  width:90%;
  max-width:380px;
  max-height:80vh;
  overflow:auto;
}
#ruleBox h3{text-align:center;margin-top:0;}

.ruleBtn{
  position:fixed;
  right:10px;
  bottom:10px;
  font-size:20px;
  border-radius:50%;
  width:48px;
  height:48px;
  z-index:500;
}
</style>
</head>

<body>
<div id="game">

<h2>ğŸ² ãƒ¨ãƒƒãƒˆãƒ€ã‚¤ã‚¹</h2>

<!-- ãƒ«ãƒ¼ãƒ«ãƒœã‚¿ãƒ³ï¼ˆå¸¸æ™‚è¡¨ç¤ºï¼‰ -->
<button class="ruleBtn" onclick="openRules()">ï¼Ÿ</button>

<div id="setup">
<button onclick="openRules()">ğŸ“˜ ãƒ«ãƒ¼ãƒ«ã‚’è¦‹ã‚‹</button>

<div id="ruleOverlay" onclick="closeRules(event)">
  <div id="ruleBox">
    <h3>ğŸ¯ ãƒ«ãƒ¼ãƒ«èª¬æ˜</h3>
    <ul>
      <li><b>1ã€œ6</b>ï¼šå‡ºãŸç›® Ã— æ•°</li>
      <li><b>3D</b>ï¼šåŒã˜ç›®3ã¤ä»¥ä¸Šï¼ˆåˆè¨ˆï¼‰</li>
      <li><b>4D</b>ï¼šåŒã˜ç›®4ã¤ä»¥ä¸Šï¼ˆåˆè¨ˆï¼‰</li>
      <li><b>FH</b>ï¼šãƒ•ãƒ«ãƒã‚¦ã‚¹ï¼ˆ25ç‚¹ï¼‰</li>
      <li><b>SS</b>ï¼šå°ã‚¹ãƒˆãƒ¬ãƒ¼ãƒˆï¼ˆ30ç‚¹ï¼‰</li>
      <li><b>LS</b>ï¼šå¤§ã‚¹ãƒˆãƒ¬ãƒ¼ãƒˆï¼ˆ40ç‚¹ï¼‰</li>
      <li><b>Y</b>ï¼šãƒ¨ãƒƒãƒˆï¼ˆ50ç‚¹ / 2å›ç›®ä»¥é™100ç‚¹ï¼‰</li>
      <li><b>C</b>ï¼šãƒãƒ£ãƒ³ã‚¹ï¼ˆåˆè¨ˆï¼‰</li>
      <li><b>ãƒœãƒ¼ãƒŠã‚¹</b>ï¼šä¸Šæ®µ63ç‚¹ä»¥ä¸Šã§ +35</li>
    </ul>
    <button onclick="closeRules()">é–‰ã˜ã‚‹</button>
  </div>
</div>

äººæ•°:
<select id="players">
<option value="1">1</option>
<option value="2">2</option>
<option value="3">3</option>
<option value="4">4</option>
</select>

CPU:
<select id="cpu">
<option value="0">0</option>
<option value="1">1</option>
<option value="2">2</option>
<option value="3">3</option>
</select>

é›£æ˜“åº¦:
<select id="cpuLevel">
<option>easy</option>
<option>normal</option>
<option>hard</option>
<option>lunatic</option>
</select>

<br><br>
<button onclick="startGame()">START</button>
</div>

<div id="play" style="display:none">
<h3 id="turn"></h3>
<div id="diceArea"></div>
<button id="rollBtn" onclick="roll()">ROLL</button>

<div>
<button onclick="saveGame()">ğŸ’¾</button>
<button onclick="loadGame()">ğŸ“‚</button>
<button onclick="deleteSave()">ğŸ—‘</button>
</div>

<div id="scoreAll"></div>
</div>

<footer>Â© 2025 STAR CORPORATION</footer>

<script>
function openRules(){document.getElementById("ruleOverlay").style.display="flex";}
function closeRules(e){
 if(!e || e.target.id==="ruleOverlay")
  document.getElementById("ruleOverlay").style.display="none";
}

let dice=[],hold=[],rolls=3,players=[],current=0;
const cats=["1","2","3","4","5","6","3D","4D","FH","SS","LS","Y","C"];
const rand=()=>Math.floor(Math.random()*6)+1;

/* ä»¥ä¸‹ã‚²ãƒ¼ãƒ ãƒ­ã‚¸ãƒƒã‚¯ï¼ˆå‰ã¨åŒã˜ãƒ»å®Œå…¨å‹•ä½œï¼‰ */
function startGame(){
players=[];
const p=+players.value,c=+cpu.value,l=cpuLevel.value;
for(let i=0;i<p;i++)
players.push({name:i<p-c?`P${i+1}`:`CPU${i+1}`,cpu:i>=p-c,level:l,score:{},yacht:0});
setup.style.display="none"; play.style.display="block";
nextTurn();
}

function nextTurn(){
rolls=3;
dice=Array(5).fill(0).map(rand);
hold=[0,0,0,0,0];
draw();
if(players[current].cpu)setTimeout(cpuPlay,600);
}

function roll(){
if(rolls<=0)return;
dice=dice.map((v,i)=>hold[i]?v:rand());
rolls--;
draw();
}

function draw(){
rollBtn.disabled=rolls<=0;
turn.textContent=`${players[current].name} ã®ç•ªï¼ˆæ®‹ã‚Š${rolls}ï¼‰`;
diceArea.innerHTML="";
dice.forEach((v,i)=>{
let s=document.createElement("span");
s.textContent=v;
s.className="dice"+(hold[i]?" hold":"");
s.onclick=()=>{hold[i]=!hold[i];draw();}
diceArea.appendChild(s);
});
drawScore();
}

function drawScore(){
scoreAll.innerHTML="";
players.forEach((p,i)=>{
let t=`<table ${i===current?'class="active"':''}><tr><th colspan=2>${p.name}</th></tr>`;
cats.forEach(c=>{
t+=`<tr onclick="choose('${c}')"><td>${c}</td><td>${p.score[c]??""}</td></tr>`;
});
let upper=["1","2","3","4","5","6"].reduce((s,k)=>s+(p.score[k]||0),0);
t+=`<tr><td>ä¸Šæ®µ</td><td>${upper}</td></tr>`;
t+=`<tr><td>ãƒœãƒ¼ãƒŠã‚¹</td><td>${upper>=63?35:0}</td></tr>`;
let total=Object.values(p.score).reduce((a,b)=>a+(b||0),0)+(upper>=63?35:0);
t+=`<tr><th>åˆè¨ˆ</th><th>${total}</th></tr></table>`;
scoreAll.innerHTML+=t;
});
}

function choose(c){
if(players[current].score[c]!=null)return;
players[current].score[c]=calc(c);
current=(current+1)%players.length;
nextTurn();
}

function calc(c){
let cnt=[0,0,0,0,0,0];
dice.forEach(v=>cnt[v-1]++);
let sum=dice.reduce((a,b)=>a+b,0);
if("123456".includes(c))return cnt[c-1]*c;
if(c==="3D")return cnt.some(v=>v>=3)?sum:0;
if(c==="4D")return cnt.some(v=>v>=4)?sum:0;
if(c==="FH")return cnt.includes(3)&&cnt.includes(2)?25:0;
if(c==="SS")return["1234","2345","3456"].some(s=>[...s].every(n=>cnt[n-1]))?30:0;
if(c==="LS")return["12345","23456"].some(s=>[...s].every(n=>cnt[n-1]))?40:0;
if(c==="Y"){players[current].yacht++;return players[current].yacht>1?100:50;}
if(c==="C")return sum;
}

function saveGame(){
localStorage.setItem("yachtSave",JSON.stringify({players,current,dice,hold,rolls}));
}
function loadGame(){
let s=JSON.parse(localStorage.getItem("yachtSave"));
if(!s)return alert("ã‚»ãƒ¼ãƒ–ãªã—");
players=s.players;current=s.current;dice=s.dice;hold=s.hold;rolls=s.rolls;
setup.style.display="none";play.style.display="block";draw();
}
function deleteSave(){
if(confirm("å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ")){localStorage.removeItem("yachtSave");location.reload();}
}
</script>
</body>
</html>
